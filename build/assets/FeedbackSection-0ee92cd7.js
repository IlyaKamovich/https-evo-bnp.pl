var E=Object.defineProperty,O=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var k=(t,a,e)=>a in t?E(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e,p=(t,a)=>{for(var e in a||(a={}))M.call(a,e)&&k(t,e,a[e]);if(N)for(var e of N(a))I.call(a,e)&&k(t,e,a[e]);return t},u=(t,a)=>O(t,D(a));var g=(t,a,e)=>new Promise((i,n)=>{var d=l=>{try{h(e.next(l))}catch(m){n(m)}},f=l=>{try{h(e.throw(l))}catch(m){n(m)}},h=l=>l.done?i(l.value):Promise.resolve(l.value).then(d,f);h((e=e.apply(t,a)).next())});import{j as s,C as U}from"./index-08929282.js";import{r as b}from"./react-9770042a.js";import{a as C,F as T}from"./Feedback-20b61b48.js";import{a as R}from"./axios-ac66676c.js";import{n as A,M as L,R as F,I as v,U as B}from"./antd-506106c0.js";import"./reactDom-76a1a9f3.js";const J=(t,a)=>{const e=new FileReader;e.addEventListener("load",()=>a(e.result)),e.readAsDataURL(t)};function K(t,a){return g(this,null,function*(){const i=yield(yield fetch(t)).blob();return new File([i],a,{type:"image/png"})})}const P="images/upload.webp",S={rate:5,name:"",text:"",url:`${window.location.href.substring(0,90)}`,photo:""},V=({isOpen:t,onCancel:a})=>{const[e,i]=A.useNotification(),[n,d]=b.useState(S),f=b.useMemo(()=>{const o=JSON.parse(JSON.stringify(n));return delete o.photo,Object.values(o).some(c=>!String(c).length)},[n]),h=o=>{d(c=>u(p({},c),{rate:o}))},l=o=>{J(o.file.originFileObj,c=>{d(r=>u(p({},r),{photo:c}))})},m=o=>{d(c=>u(p({},c),{name:o.target.value}))},x=o=>{d(c=>u(p({},c),{text:o.target.value}))},j=()=>{a(),d(S)},y=()=>g(void 0,null,function*(){const o=new FormData,c=JSON.parse(JSON.stringify(n));if(delete c.photo,n.photo.length){const r=`file-${crypto.randomUUID()}`,w=yield K(n.photo,r);o.append("file",w,r)}Object.keys(c).forEach(r=>o.append(r,String(c[r])));try{const r=yield R.post(U.REQUESTS.SEND_FEEDBACK,o,{headers:{"Content-Type":"multipart/form-data"}});j(),e.success({key:"success",message:r.data.message})}catch(r){console.log(r),e.error({key:"error",message:"Произошла ошибка повторите позже!"})}});return s.jsxs(s.Fragment,{children:[i,s.jsx(L,{title:"Напишите свой отзыв",open:t,onOk:a,onCancel:j,footer:null,children:s.jsxs("div",{className:"modal-body",children:[s.jsx(F,{defaultValue:5,value:n.rate,onChange:h}),s.jsx(v,{value:n.name,placeholder:"Ваше имя",className:"input",onChange:m}),s.jsx(v,{value:n.text,placeholder:"Напишите свой отзыв",className:"input",onChange:x}),s.jsx("div",{style:{overflow:"hidden"},children:s.jsx(B,{listType:"picture-card",showUploadList:!1,onChange:l,children:s.jsx("img",{src:n.photo||P,alt:"avatar",style:{width:"100%"}})})}),s.jsx("button",{type:"button",className:"send-button",disabled:f,onClick:y,children:"Отправьте свой отзыв"})]})})]})};const _=({name:t,rate:a,photo:e,text:i})=>s.jsxs("div",{className:"feedback-card",children:[s.jsx("h3",{className:"title",children:t}),s.jsx(F,{className:"stars",value:a,disabled:!0}),e&&s.jsx("img",{src:e,className:"photo",alt:"rate"}),s.jsx("p",{className:"text",children:i})]});const $="icons/pencil.svg",Y=()=>{const[t,a]=b.useState(3),[e,i]=b.useState(!1),n=b.useMemo(()=>C.slice(0,t),[t]),d=()=>{i(!0)},f=()=>{i(!1)},h=()=>{a(m=>m+3)},l=C.length===t;return s.jsxs("section",{id:"feedback",className:"feedback-section",children:[s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"header",children:[s.jsx("h2",{className:"title",children:"Отзывы"}),s.jsxs("div",{className:"header-right",children:[s.jsx(T,{}),s.jsxs("button",{type:"button",className:"write-feedback",onClick:d,children:[s.jsx("img",{src:$,alt:"pencil"}),"Написать отзыв"]})]})]}),s.jsx("div",{className:"feedback-list",children:n.map((m,x)=>b.createElement(_,u(p({},m),{key:x})))}),s.jsx("div",{className:"feedback-footer",children:s.jsx("button",{disabled:l,onClick:h,className:"feedback-footer-button",children:"Показать больше"})})]}),s.jsx(V,{isOpen:e,onCancel:f})]})};export{Y as default};
